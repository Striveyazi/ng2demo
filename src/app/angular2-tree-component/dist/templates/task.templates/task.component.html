<div
      *ngIf="!task.isHidden"
      class="tree-node tree-node-level-{{ task.level }}"
      [class.tree-node-expanded]="task.isExpanded && task.data && task.hasChildren"
      [class.tree-node-collapsed]="task.isCollapsed && task.data &&task.hasChildren"
      [class.tree-node-leaf]="task.isLeaf"
      [class.tree-node-active]="task.isActive"
      [class.tree-node-focused]="task.isFocused">

      <TreeNodeDropSlot
        *ngIf="nodeIndex === 0"
        [dropIndex]="nodeIndex"
        [task]="task.parent"
        ></TreeNodeDropSlot>
        <div class="task-container">
		      <!-- toggle -->
		      <span
		        *ngIf="task.data &&task.data.hasChild"
		        class="toggle-children-wrapper fl"
		        (click)="expanded()">
		         <span class="toggle-children fa fa-angle-down"></span>		
		      </span>
		      <!--<span
		        *ngIf="!(task.data &&task.data.hasChild)"
		        class="toggle-children-placeholder fl">
		      </span>-->
		      <div class="node-content-wrapper drop-down"
		        #nodeContentWrapper
		        [class.is-dragging-over]="task.treeModel.isDraggingOver(this)"
		        (click)="task.mouseAction('click', $event,{totree:task.treeModel})"
		        (dblclick)="task.mouseAction('dblClick', $event,{totree:task.treeModel})"
		        (contextmenu)="task.mouseAction('contextMenu', $event,{totree:task.treeModel})"
		        [draggable]="task.allowDrag()"
		        (dragstart)="onDragStart($event)"
		        (drop)="onDrop($event)"
		        (dragend)="onDragEnd()"
		        (dragover)="onDragOver($event)"
		        (dragleave)="onDragLeave(nodeContentWrapper, $event)"
		        >
		
		        <TreeNodeContent [task]="task" [treeNodeContentTemplate]="treeNodeContentTemplate"></TreeNodeContent>
		      </div>

      </div>
      <div class="tree-children" *ngIf="task.isExpanded">
        <div *ngIf="task.data &&task.data.hasChild">
          <TreeNode
            *ngFor="let child_task of task.children; let i = index"
            [task]="child_task"
            [nodeIndex]="i"
            [treeNodeContentTemplate]="treeNodeContentTemplate"
            [loadingTemplate]="loadingTemplate">
          </TreeNode>
        </div>
        <LoadingComponent
          class="tree-node-loading"
          *ngIf="!task.children"
          [loadingTemplate]="loadingTemplate"
        ></LoadingComponent>
      </div>
      <TreeNodeDropSlot
        [dropIndex]="nodeIndex + 1"
        [task]="task.parent"
        ></TreeNodeDropSlot>
</div>